## 오늘 진행한 작업 요약 (2026-01-24)

- **목표:** 로컬 CLI 기반 Flashcard 자료 생산 엔진(MVP v0.1) 통합 테스트 및 튜닝, 출력 계약(이미지 + result.json + review_queue.json + metrics.json + errors.jsonl) 검증

- **환경:** Windows, Python 3.11 가상환경(`.venv`) — PaddleOCR 안정 동작을 위해 Python 3.11 사용 권장

- **주요 의사결정/변경사항**
  - PaddleOCR 동작 안정화를 위해 `paddlepaddle==2.6.2`, `paddleocr<3`, `pillow==10.4.0` 설치
  - `segmenter` 관련 버그 수정: 중복/정의되지 않은 지역변수 제거 및 `run_single_word` 재구성
  - `--segmenter off` 옵션이 실제로 분절 단계를 비활성화하도록 `pipeline.py`/`segmenter.py` 수정
  - PaddleOCR 내부 로그 억제를 위해 `ocr.py`에서 `show_log=False` 설정
  - 설정 튜닝: `config/default.json`에서 `segment.expand_scale=5.0`, `segment.min_area_ratio=0.01`

- **생성된 작업(Job) 샘플**
  - STEP1 (segmenter off): `workspace/jobs/ad594bc7-b0b8-46c2-848e-ce7cb71b51d1/`
  - STEP2 (mobilesam, 튜닝 적용): `workspace/jobs/31c698ca-cba9-4c4d-bf14-ee66b3a6a42a/`

- **간단 실행 커맨드 예시**
  ```powershell
  .\.venv\Scripts\python -m flashcard_engine.cli run --input .\Images --type images --lang en --workspace .\workspace --source "ImagesTest" --min-confidence 0.7 --segmenter off --segmenter-device cpu --config .\config\default.json
  ```

- **다음 권장 작업**
  - `samples/book.pdf` 업로드 후 PDF 파이프라인(STEP 3) 실행 및 검증
  - segmenter 모델(또는 MobileSAM) 실제 설치/연동 테스트 (현재는 bbox_fallback 사용)
  - 출력 품질 향상을 위한 OCR 사전처리·후처리 규칙 추가
